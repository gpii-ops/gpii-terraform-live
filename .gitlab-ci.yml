variables:
  # Ownership/permission conflicts in /tmp/terragrunt-download are possible, so set TMPDIR to a path inside the build.
  TMPDIR: "$CI_PROJECT_DIR/gitlab-tmp"

before_script:
  - cd dev
  - echo "$TMPDIR"  # So it's visible in the log
  - mkdir "$TMPDIR"
  - bundle install --path "$TMPDIR/vendor/bundle"

test:
  script:
    - bundle exec kitchen test -l debug

after_script:
  - cd dev
  - bundle exec kitchen destroy -l debug
